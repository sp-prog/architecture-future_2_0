# Функциональные требования

1. FT-1. Интегрировать в свою систему фарм.компании
2. FT-2. Интегрировать в свою систему производителя медицинского оборудования
12. FT-4. Иметь единую картину по бизнес-показателям.
13. FT-5. Иметь единый портал самообслуживания
14. FT-6. Разделение уровня доступа сотрудников к данным. Учет этого уровня при составлении отчетов
15. FT-7. Наличие возможности конструировать отчеты самостоятельно
16. FT-8. Исключение медицинских данных из отчетов

# Нефункциональные требования

1. NFT-1. Ускорить создание отчетов
2. NFT-2. Легкое масштабирование портала самообслуживания
3. NFT-3. Максимально возможный уровень сопровождаемости, развертываемости
4. NFT-4. Использование DDD (предметных областей)
3. NFT-5. Развивать все направления работы независимо
4.    NFT-5-1. Работа с клиентами
5.    NFT-5-2. Медицинские карты и истории болезни, в том числе — данные исследований, выполненных в ходе лечения.
6.    NFT-5-3. Финансовая история.
7.    NFT-5-4. Счета.
8.    NFT-5-5. Кредитах.
9.    NFT-5-6. Данные по персоналу больницы.
10.   NFT-5-7. Инвентаризация.
11.   NFT-5-8. Финансовая отчётность и много другой информации.

# Анализ требований

## Архитектура сервисов

Для обоснования использования архитектуры микросервисов достаточно сослаться на NFT-4, т.к. разбиение по предметным областям является отличительной особенностью этой архитектуры.

В дополнении можно указать, что микросервисная архитектура легче остальных поддается масштабированию, доработке и поставке (NFT-1 - NFT-3)

Микросервисная архитектура в виду повышенных требований к независимости микросервисов друг от друга обладает требуемыми свойства (NFT-2, NFT-3? NFT-5):
- высокой развертываемостью, т.е. бизнес-функции, реализованные в одном сервисе, могут быть запущены или обновлены без влияние на другие бизнес-функции
- прекрасной адаптируемостью (обработка всплесков нагрузки), масштабируемостью (реакция на стабильный рост нагрузки)
- хорошей тестируемостью
и др.

## Архитектура сервисов больших данных

Существует три способа работы с большими данными:
1. Хранилище данных
2. Озеро данных
3. Сетка данных, которая сливает данные каким-либо образом в хранилище или озеро или в оба сразу

Первые два подхода сосредоточены на техническом разбиении данных, связанны с высокой сложностью при работе с данными в следствии разрушения связей между ними. Проще говоря, в обоих подходах данные сваливаются в общий котел. В случае второго подхода данные еще и перемешиваются в кашу, из которой необходимо при анализе восстанавливать исходный смысл и вид ингредиентов.

В первом подходе данные легко разрушаются при изменении систем источников, что противоречит NFT-5

В третьем подходе данные сохраняют свой изначальный контекст. Так же этот способ работы с большими данным в качестве основы использует понятия предметной области (NFT-4). Такие данные проще помечать тегами доступа (FT-6) и собирать из них отчеты (FT-7) в следствии сохранения изначальных связей внутри таких данных.

Для уменьшения влияния сетки на базы данных сервисов необходимо добавить к каждой БД каждого сервиса асинхронную реплику, с которой будет работать сетка данных

# Проблемные места

ПМ-1. Использования единой реляционной БД для работы всех сервисов компании и аналитики.
   1. Единая БД с большим количеством данных плохо поддается масштабированию, реплицированию, бекапированию. Проблемы с единой БД отражаются сразу на всех сервисах компании, а значит и на всех пользователя и клиентах. Например, обслуживание серверов потребует приостановки деятельности
   2. Единая БД больших размеров требует большего времени на восстановление, т.е. увеличивает время вынужденного простоя сотрудников и количеств клиентов, которые не смогут воспользоваться услугами компании
   3. В какой-то момент времени мощности сервера, на котором работает СУБД, невозможно будет нарастить. В результате ее производительность начнет деградировать и базу придется каким-то образов разделять на части в авральном режиме. Пользователи и сотрудники столкнутся с замедлением работы сервисов. Качество предоставляемых услуг упадет.
   4. БД сервисов, объединенные с БД аналитики, могут быть причиной падения качества услуг, предоставляемых клиентам, если во время предоставления услуг будет производиться расчет аналитических показателей. Обычно такие расчеты ресурсоёмки, а с учетом плохой масштабируемости, расчеты будут потреблять ресурсы, выделенные на обслуживание клиентов.
   5. Большая нагрузка на единую БД может приводить к отказам в обслуживании клиентов, что в свою очередь может быть причиной подачи жалоб регулятору с последующим наложением штрафов
   6. Обычно к хранению медицинских и финансовых данных предъявляются повышенные требования к конфиденциальности и хранению. Из общего набора правил хранения обычно выбираются самые строгие. Единая база накладывает эти самые строгие требования на все данные БД и все сервисы, которые имеют доступ к этим БД. И ко всем пользователям.
   7. При создании новых функциональностей приходится дописывать большой объем бизнес-логики, что замедляет вывод на рынок новых услуг

# Приоритеты

Для расстановки приоритетов необходимо у каждой проблемы проставить вероятность возникновения риска и степень влияния риска на работу компании

При анализе необходимо учесть будущее значительное увеличение объёмов хранилища в связи с подключением новых компаний к хранилищу

|Проблемные места | Вероятность возникновения риска | Степень влияния | Комментарий
| --- | --- | --- | --- |
| ПМ-1 | Неизбежно | Низкая | Обслуживание серверов происходило и раньше. Если компания до сих пор работает именно так, то ее это устраивает. Но это точно происходит запланировано |
| ПМ-2 | Низкая | Низкая | Выведение БД из строя является достаточно редким явлением. При наличии бэкапа и отсутствии проблем с безопасностью, риски такие же, как и всегда |
| ПМ-3 | Средняя | Высокий | В связи с подключением новых источников данных для новой БД может случится и такое |
| ПМ-4 | Высокий | Низкий | Судя по тому, что сейчас все работает именно так, то для компании это не является приоритетом |
| ПМ-5 | Средний | Высокий | При увеличении данных только вопрос времени, когда будет наложен штраф |
| ПМ-6 | Низкий | Средний | В компании не наблюдается проблем с безопасностью, но если данные сопрут, то это может привести к серьезным последствиям для компании вообще и для руководства в частности |
| ПМ-7 | Уже так | Средний | Сейчас компания уже сталкивается с проблемами создания новых услуг |

Из таблицы выше следует такой порядок работ над проблемами:
1. ПМ-7
2. ПМ-1
3. ПМ-4
4. ПМ-3 и ПМ-5
5. ПМ-6
6. ПМ-2

